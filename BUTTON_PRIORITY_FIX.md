# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: –ö–Ω–æ–ø–∫–∏ —Å –≤—ã—Å—à–∏–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º

## ‚ùå –ü—Ä–æ–±–ª–µ–º–∞
–ë–æ—Ç –≤—Å–µ –µ—â–µ –æ—Ç–≤–µ—á–∞–ª "–Ω–µ –∑–Ω–∞—é —á—Ç–æ –æ—Ç–≤–µ—Ç–∏—Ç—å" –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ –∫–Ω–æ–ø–∫–∏ "üîí –ó–∞–∫—Ä—ã—Ç—å —Å–º–µ–Ω—É" –∏ "üí∏ –°–ø–∏—Å–∞—Ç—å —Å –∫–∞—Å—Å—ã", –¥–∞–∂–µ –ø–æ—Å–ª–µ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π.

## üîç –ü—Ä–∏—á–∏–Ω–∞
**–ü–æ—Ä—è–¥–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤ python-telegram-bot:**

1. –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –≤ –≥—Ä—É–ø–ø–µ `-1` (–≤—ã—Å—à–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
2. –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –≤ –≥—Ä—É–ø–ø–µ `0` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
   - ConversationHandlers
   - CommandHandlers
   - MessageHandlers
3. –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –≤ –≥—Ä—É–ø–ø–µ `1+` (–Ω–∏–∑—à–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–æ—Ç)

**–ü—Ä–æ–±–ª–µ–º–∞:** ConversationHandlers —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª–∏—Å—å —Ä–∞–Ω—å—à–µ –Ω–∞—à–∏—Ö MessageHandlers –¥–ª—è –∫–Ω–æ–ø–æ–∫, –ø–æ—ç—Ç–æ–º—É –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –±—ã–ª –≤–Ω—É—Ç—Ä–∏ conversation (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∑–∞–∫—Ä—ã–≤–∞–ª —Å–º–µ–Ω—É), –≤—Å–µ –µ–≥–æ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–ª–∏—Å—å conversation handler'–æ–º.

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª –æ—Ç–¥–µ–ª—å–Ω—ã–µ MessageHandlers –¥–ª—è –∫–Ω–æ–ø–æ–∫ –≤ **–≥—Ä—É–ø–ø–µ -1** (–≤—ã—Å—à–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç):

```python
# Register button handlers BEFORE conversation handlers (highest priority)
application.add_handler(MessageHandler(
    filters.TEXT & filters.Regex("^üîí –ó–∞–∫—Ä—ã—Ç—å —Å–º–µ–Ω—É$"), 
    handle_close_shift_button
), group=-1)  # <-- –≥—Ä—É–ø–ø–∞ -1 = –≤—ã—Å—à–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç

application.add_handler(MessageHandler(
    filters.TEXT & filters.Regex("^üí∏ –°–ø–∏—Å–∞—Ç—å —Å –∫–∞—Å—Å—ã$"), 
    handle_expense_button
), group=-1)

application.add_handler(MessageHandler(
    filters.TEXT & filters.Regex("^üí∞ –í–∑—è—Ç—å –∑–∞—Ä–ø–ª–∞—Ç—É$"), 
    handle_withdrawal_button
), group=-1)

application.add_handler(MessageHandler(
    filters.TEXT & filters.Regex("^üîì –û—Ç–∫—Ä—ã—Ç—å —Å–º–µ–Ω—É$"), 
    handle_open_shift_button
), group=-1)
```

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

**–ü–æ—Ä—è–¥–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ç–µ–ø–µ—Ä—å:**
1. **–ì—Ä—É–ø–ø–∞ -1**: –ö–Ω–æ–ø–∫–∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã (üîí üîì üí∏ üí∞) ‚Üê **–ù–ê–ò–í–´–°–®–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢**
2. **–ì—Ä—É–ø–ø–∞ 0**: ConversationHandlers, Commands, –¥—Ä—É–≥–∏–µ MessageHandlers
3. **handle_message**: –ù–µ–π—Ä–æ–Ω–∫–∞ –∏ –æ–±—â–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞

–¢–µ–ø–µ—Ä—å –∫–Ω–æ–ø–∫–∏ **–≤—Å–µ–≥–¥–∞** –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –ø–µ—Ä–≤—ã–º–∏, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ç–æ–≥–æ, –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤ conversation –∏–ª–∏ –Ω–µ—Ç!

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

**group parameter –≤ add_handler:**
- `group=-1` - –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –ø–µ—Ä–≤—ã–º (–≤—ã—Å—à–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
- `group=0` - –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (—Å—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
- `group=1+` - –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ–¥–Ω–∏–º (–Ω–∏–∑—à–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)

–ö–Ω–æ–ø–∫–∏ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–∞ 100%! ‚úÖ
