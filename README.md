# ü§ñ Club Assistant Bot v4.11

## üéØ –ß—Ç–æ –Ω–æ–≤–æ–≥–æ –≤ v4.11

### üîê V2Ray Manager
–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä–∞–º–∏ —á–µ—Ä–µ–∑ –±–æ—Ç–∞:
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ V2Ray –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π
- –ê–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è VLESS —Å—Å—ã–ª–æ–∫
- –ú–∞—Å–∫–∏—Ä–æ–≤–∫–∞ —Ç—Ä–∞—Ñ–∏–∫–∞ (TCP/WS/gRPC/TLS)
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏

### üè¢ Club Management System
–ö–æ–Ω—Ç—Ä–æ–ª—å –∑–∞ –∞–¥–º–∏–Ω–∞–º–∏ –∏ –∫–ª—É–±–∞–º–∏:
- –ö—Ä–∞—Å–∏–≤—ã–µ –æ—Ç—á—ë—Ç—ã —Å–º–µ–Ω —Å –∞–≤—Ç–æ–ø–∞—Ä—Å–∏–Ω–≥–æ–º
- –£—á—ë—Ç —Ñ–∏–Ω–∞–Ω—Å–æ–≤ (–Ω–∞–ª–∏—á–∫–∞, –±–µ–∑–Ω–∞–ª, QR)
- –ö–æ–Ω—Ç—Ä–æ–ª—å –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Ä–∞—Å—Ö–æ–¥–Ω–∏–∫–æ–≤
- –°–≤–æ–¥–∫–∞ –ø–æ –ø—Ä–æ–±–ª–µ–º–∞–º
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–ª—É–±–∞–º

---

## üìã –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### üí¨ –£–º–Ω—ã–π –±–æ—Ç
- RAG (Retrieval-Augmented Generation)
- –í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π
- –ê–≤—Ç–æ–æ–±—É—á–µ–Ω–∏–µ –≤ –≥—Ä—É–ø–ø–∞—Ö
- GPT-4 fallback

### üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∞–º–∏
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–æ–≤
- –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
- –•—Ä–∞–Ω–µ–Ω–∏–µ —É—á—ë—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### üìä –ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è
- –î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è
- –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
- –û—á–∏—Å—Ç–∫–∞ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

---

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Ubuntu 20.04+
- Python 3.8+
- Systemd

### –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
# 1. –ö–ª–æ–Ω–∏—Ä—É–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
cd /opt
git clone https://github.com/nik45114/Bot_Claude.git club_assistant
cd club_assistant

# 2. –£—Å—Ç–∞–Ω–æ–≤–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip3 install -r requirements.txt --break-system-packages

# 3. –ù–∞—Å—Ç—Ä–æ–π –∫–æ–Ω—Ñ–∏–≥
cp config.json.example config.json
nano config.json

# –î–æ–±–∞–≤—å:
# - telegram_token
# - openai_api_key
# - admin_ids
# - owner_id (–¥–ª—è V2Ray –∏ Club Management)

# 4. –ù–∞—Å—Ç—Ä–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
cp .env.example .env
nano .env

# –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
# - TELEGRAM_BOT_TOKEN
# - OPENAI_API_KEY
# - OWNER_TG_IDS (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≤–ª–∞–¥–µ–ª—å—Ü–µ–≤)
#
# –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ:
# - DB_PATH (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: knowledge.db)
# - BACKUP_DIR (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: ./backups)
# - BACKUP_INTERVAL_DAYS (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 14)
# - GOOGLE_SA_JSON (–¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å Google Sheets)

# 5. –ó–∞–ø—É—Å—Ç–∏ –º–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
python3 run_migrations.py

# 6. –ó–∞–ø—É—Å—Ç–∏ –±–æ—Ç–∞
python3 bot.py
```

### –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ systemd

```bash
# –°–æ–∑–¥–∞–π —Å–µ—Ä–≤–∏—Å
sudo nano /etc/systemd/system/club_assistant.service
```

```ini
[Unit]
Description=Club Assistant Bot
After=network.target

[Service]
Type=simple
User=root
WorkingDirectory=/opt/club_assistant
ExecStart=/usr/bin/python3 /opt/club_assistant/bot.py
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target
```

```bash
# –ó–∞–ø—É—Å—Ç–∏
sudo systemctl daemon-reload
sudo systemctl enable club_assistant
sudo systemctl start club_assistant

# –ü—Ä–æ–≤–µ—Ä—å —Å—Ç–∞—Ç—É—Å
sudo systemctl status club_assistant
```

---

## üìñ –ö–æ–º–∞–Ω–¥—ã

### ü§ñ –û—Å–Ω–æ–≤–Ω—ã–µ
```
/start - –°—Ç–∞—Ä—Ç
/help - –°–ø—Ä–∞–≤–∫–∞
/stats - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–∞–∑—ã
```

### üìö –ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π
```
/search <–∑–∞–ø—Ä–æ—Å> - –ü–æ–∏—Å–∫
/teach <–≤–æ–ø—Ä–æ—Å> | <–æ—Ç–≤–µ—Ç> - –î–æ–±–∞–≤–∏—Ç—å –∑–Ω–∞–Ω–∏–µ
/forget <id> - –£–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å—å
/category <id> <–∫–∞—Ç–µ–≥–æ—Ä–∏—è> - –ò–∑–º–µ–Ω–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é
```

### üë• –ê–¥–º–∏–Ω—ã
```
/addadmin <user_id> - –î–æ–±–∞–≤–∏—Ç—å –∞–¥–º–∏–Ω–∞
/admins - –°–ø–∏—Å–æ–∫ –∞–¥–º–∏–Ω–æ–≤
/savecreds <—Å–µ—Ä–≤–∏—Å> <–ª–æ–≥–∏–Ω> <–ø–∞—Ä–æ–ª—å> - –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —É—á—ë—Ç–∫—É
/getcreds - –ü–æ–ª—É—á–∏—Ç—å —É—á—ë—Ç–∫–∏
```

### üßπ –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ
```
/cleanup - –û—á–∏—Å—Ç–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
/fixdb - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–∑—ã
/deletetrash - –£–¥–∞–ª–µ–Ω–∏–µ –º—É—Å–æ—Ä–∞
/fixjson - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ JSON –≤ –æ—Ç–≤–µ—Ç–∞—Ö
/import - –ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
```

### üîê V2Ray (—Ç–æ–ª—å–∫–æ owner)
```
/v2ray - –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
/v2add <–∏–º—è> <host> <user> <pass> - –î–æ–±–∞–≤–∏—Ç—å —Å–µ—Ä–≤–µ—Ä
/v2setup <–∏–º—è> - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å V2Ray
/v2user <—Å–µ—Ä–≤–µ—Ä> <user_id> [email] - –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
/v2list - –°–ø–∏—Å–æ–∫ —Å–µ—Ä–≤–µ—Ä–æ–≤
/v2stats <–∏–º—è> - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
/v2traffic <—Å–µ—Ä–≤–µ—Ä> <—Ç–∏–ø> - –ò–∑–º–µ–Ω–∏—Ç—å —Ç—Ä–∞—Ñ–∏–∫
```

### üè¢ –ö–ª—É–±—ã (—Ç–æ–ª—å–∫–æ owner)
```
/clubs - –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
/clubadd <–Ω–∞–∑–≤–∞–Ω–∏–µ> <–∞–¥—Ä–µ—Å> - –î–æ–±–∞–≤–∏—Ç—å –∫–ª—É–±
/clublist - –°–ø–∏—Å–æ–∫ –∫–ª—É–±–æ–≤
/report <–∫–ª—É–±> - –û—Ç—á—ë—Ç —Å–º–µ–Ω—ã
/lastreport <–∫–ª—É–±> - –ü–æ—Å–ª–µ–¥–Ω–∏–π –æ—Ç—á—ë—Ç
/clubstats <–∫–ª—É–±> [–¥–Ω–µ–π] - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
/issues [–∫–ª—É–±] - –ü—Ä–æ–±–ª–µ–º—ã
```

### üí∞ FinMon - –§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
```
/shift - –°–¥–∞—Ç—å —Å–º–µ–Ω—É (–∫–Ω–æ–ø–æ—á–Ω—ã–π –≤–∏–∑–∞—Ä–¥)
/balances - –¢–µ–∫—É—â–∏–µ –±–∞–ª–∞–Ω—Å—ã –∫–∞—Å—Å
/shifts - –ü–æ—Å–ª–µ–¥–Ω–∏–µ —Å–º–µ–Ω—ã
```

### üíæ –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ (—Ç–æ–ª—å–∫–æ owner)
```
/migration - –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ñ–∞–π–ª—ã –º–∏–≥—Ä–∞—Ü–∏–π –ë–î
/backup - –°–æ–∑–¥–∞—Ç—å –∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–æ–ª–Ω—ã–π –±—ç–∫–∞–ø
```

---

## üóÉÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –º–∏–≥—Ä–∞—Ü–∏–∏

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ë–î

–ë–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç SQLite –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö. –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã:
- `knowledge` - –±–∞–∑–∞ –∑–Ω–∞–Ω–∏–π
- `admins` - —Å–ø–∏—Å–æ–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
- `finmon_clubs` - –∫–ª—É–±—ã –¥–ª—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- `finmon_balances` - —Ç–µ–∫—É—â–∏–µ –±–∞–ª–∞–Ω—Å—ã –∫–∞—Å—Å
- `finmon_shifts` - –∏—Å—Ç–æ—Ä–∏—è —Å–¥–∞—á–∏ —Å–º–µ–Ω
- `finmon_movements` - –∏—Å—Ç–æ—Ä–∏—è –¥–≤–∏–∂–µ–Ω–∏–π –¥–µ–Ω–µ–≥

### –ú–∏–≥—Ä–∞—Ü–∏–∏

–ú–∏–≥—Ä–∞—Ü–∏–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –ø–∞–ø–∫–µ `migrations/` –∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ –±–æ—Ç–∞.

–î–ª—è —Ä—É—á–Ω–æ–≥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–π:

```bash
python3 run_migrations.py
```

–ú–∏–≥—Ä–∞—Ü–∏–∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—é—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü–µ `_migrations` –∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑.

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –º–∏–≥—Ä–∞—Ü–∏–π

–ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ñ–∞–π–ª—ã –º–∏–≥—Ä–∞—Ü–∏–π –≤–ª–∞–¥–µ–ª—å—Ü—É –∫–∞–∂–¥—ã–µ N –¥–Ω–µ–π (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –≤ `.env`).

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ `.env`:
```bash
BACKUP_INTERVAL_DAYS=14  # –ò–Ω—Ç–µ—Ä–≤–∞–ª –æ—Ç–ø—Ä–∞–≤–∫–∏ (–¥–Ω–µ–π)
OWNER_TG_IDS=123456789   # ID –≤–ª–∞–¥–µ–ª—å—Ü–∞
```

### –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ

–í–ª–∞–¥–µ–ª–µ—Ü –º–æ–∂–µ—Ç –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç –∑–∞–ø—Ä–æ—Å–∏—Ç—å:
- `/migration` - –ø–æ–ª—É—á–∏—Ç—å –∞—Ä—Ö–∏–≤ —Å SQL-—Ñ–∞–π–ª–∞–º–∏ –º–∏–≥—Ä–∞—Ü–∏–π
- `/backup` - –ø–æ–ª—É—á–∏—Ç—å –ø–æ–ª–Ω—ã–π –±—ç–∫–∞–ø (SQLite DB + JSON/CSV —Ñ–∞–π–ª—ã)

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `BACKUP_INTERVAL_DAYS`.

---

## üîß –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
# –í –±–æ—Ç–µ:
/update

# –ò–ª–∏ –≤—Ä—É—á–Ω—É—é:
cd /opt/club_assistant
bash update.sh
```

### update.sh
```bash
#!/bin/bash
cd /opt/club_assistant
git pull origin main
pip3 install -r requirements.txt --break-system-packages
systemctl restart club_assistant
```

---

## üìä –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ v4.11

```
club_assistant/
‚îú‚îÄ‚îÄ bot.py                  # –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª –±–æ—Ç–∞
‚îú‚îÄ‚îÄ embeddings.py           # –°–µ—Ä–≤–∏—Å —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ (OpenAI)
‚îú‚îÄ‚îÄ vector_store.py         # –í–µ–∫—Ç–æ—Ä–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
‚îú‚îÄ‚îÄ draft_queue.py          # –û—á–µ—Ä–µ–¥—å —á–µ—Ä–Ω–æ–≤–∏–∫–æ–≤
‚îú‚îÄ‚îÄ v2ray_manager.py        # V2Ray —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
‚îú‚îÄ‚îÄ v2ray_commands.py       # V2Ray –∫–æ–º–∞–Ω–¥—ã
‚îú‚îÄ‚îÄ club_manager.py         # Club —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
‚îú‚îÄ‚îÄ club_commands.py        # Club –∫–æ–º–∞–Ω–¥—ã
‚îú‚îÄ‚îÄ knowledge.db            # SQLite –±–∞–∑–∞
‚îú‚îÄ‚îÄ vectors.npy             # –í–µ–∫—Ç–æ—Ä—ã –¥–ª—è –ø–æ–∏—Å–∫–∞
‚îú‚îÄ‚îÄ config.json             # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îî‚îÄ‚îÄ requirements.txt        # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```

---

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### config.json
```json
{
  "telegram_token": "YOUR_BOT_TOKEN",
  "openai_api_key": "YOUR_OPENAI_KEY",
  "admin_ids": [123456789],
  "owner_id": 123456789,
  "gpt_model": "gpt-4o-mini",
  "embedding_model": "text-embedding-3-small",
  "vector_search": {
    "top_k": 5,
    "min_score": 0.5
  }
}
```

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
- **telegram_token** - —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ –æ—Ç @BotFather
- **openai_api_key** - –∫–ª—é—á OpenAI API
- **admin_ids** - —Å–ø–∏—Å–æ–∫ ID –∞–¥–º–∏–Ω–æ–≤
- **owner_id** - ID –≤–ª–∞–¥–µ–ª—å—Ü–∞ (–¥–ª—è V2Ray –∏ Clubs)
- **gpt_model** - –º–æ–¥–µ–ª—å GPT (gpt-4o-mini / gpt-4o)
- **embedding_model** - –º–æ–¥–µ–ª—å —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤

---

## üéØ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π
```
–ê–¥–º–∏–Ω: /teach –ß—Ç–æ –¥–µ–ª–∞—Ç—å –µ—Å–ª–∏ –ü–ö –Ω–µ –≤–∫–ª—é—á–∞–µ—Ç—Å—è? | –ü—Ä–æ–≤–µ—Ä—å –∫–∞–±–µ–ª—å –ø–∏—Ç–∞–Ω–∏—è, –ø–æ–ø—Ä–æ–±—É–π –¥—Ä—É–≥—É—é —Ä–æ–∑–µ—Ç–∫—É, –ø—Ä–æ–≤–µ—Ä—å –∫–Ω–æ–ø–∫—É –≤–∫–ª—é—á–µ–Ω–∏—è

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: –ü–ö –Ω–µ –≤–∫–ª—é—á–∞–µ—Ç—Å—è
–ë–æ—Ç: –ü—Ä–æ–≤–µ—Ä—å –∫–∞–±–µ–ª—å –ø–∏—Ç–∞–Ω–∏—è, –ø–æ–ø—Ä–æ–±—É–π –¥—Ä—É–≥—É—é —Ä–æ–∑–µ—Ç–∫—É, –ø—Ä–æ–≤–µ—Ä—å –∫–Ω–æ–ø–∫—É –≤–∫–ª—é—á–µ–Ω–∏—è
```

### V2Ray
```
Owner: /v2add main 185.123.45.67 root MyPass123
       /v2setup main
       /v2user main @username –í–∞—Å—è

–ë–æ—Ç: ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–±–∞–≤–ª–µ–Ω!
     üîó VLESS —Å—Å—ã–ª–∫–∞:
     vless://uuid@185.123.45.67:443?type=tcp#username
```

### –û—Ç—á—ë—Ç—ã –∫–ª—É–±–æ–≤
```
–ê–¥–º–∏–Ω: /report –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π

–ë–æ—Ç: üìã –û—Ç—á—ë—Ç —Å–º–µ–Ω—ã - –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π
     –û—Ç–ø—Ä–∞–≤—å –æ—Ç—á—ë—Ç –≤ –ª—é–±–æ–º —Ñ–æ—Ä–º–∞—Ç–µ.

–ê–¥–º–∏–Ω: [–æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–µ–∫—Å—Ç –æ—Ç—á—ë—Ç–∞]

–ë–æ—Ç: [–∫—Ä–∞—Å–∏–≤—ã–π –æ—Ç—á—ë—Ç —Å —Ñ–∏–Ω–∞–Ω—Å–∞–º–∏, –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ–º, —Ä–∞—Å—Ö–æ–¥–Ω–∏–∫–∞–º–∏]
```

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- **owner_id** - —Ç–æ–ª—å–∫–æ –≤–ª–∞–¥–µ–ª–µ—Ü –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø –∫ V2Ray –∏ Club Management
- **admin_ids** - –∞–¥–º–∏–Ω—ã –º–æ–≥—É—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å –±–∞–∑–æ–π –∑–Ω–∞–Ω–∏–π
- –£—á—ë—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–º–∏
- SSH –¥–∞–Ω–Ω—ã–µ –¥–ª—è V2Ray —à–∏—Ñ—Ä—É—é—Ç—Å—è
- –ò—Å—Ç–æ—Ä–∏—è –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –±–∞–∑–µ

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [V2RAY_GUIDE.md](V2RAY_GUIDE.md) - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ V2Ray
- [CLUB_MANAGEMENT_GUIDE.md](CLUB_MANAGEMENT_GUIDE.md) - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ Club Management
- [UPDATE_TO_V4.11.md](UPDATE_TO_V4.11.md) - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—é

---

## üêõ –¢—Ä–∞–±–ª—à—É—Ç–∏–Ω–≥

### –ë–æ—Ç –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
```bash
# –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏
sudo journalctl -u club_assistant -f

# –ü—Ä–æ–≤–µ—Ä—å –∫–æ–Ω—Ñ–∏–≥
python3 -c "import json; json.load(open('config.json'))"

# –ü—Ä–æ–≤–µ—Ä—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip3 install -r requirements.txt --break-system-packages
```

### –û—à–∏–±–∫–∏ –≤ –±–∞–∑–µ
```bash
# –í –±–æ—Ç–µ:
/fixdb       # –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–∑—ã
/cleanup     # –û—á–∏—Å—Ç–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
/deletetrash # –£–¥–∞–ª–µ–Ω–∏–µ –º—É—Å–æ—Ä–∞
```

### V2Ray –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è
```bash
# –ü—Ä–æ–≤–µ—Ä—å SSH –¥–æ—Å—Ç—É–ø
ssh root@185.123.45.67

# –ü—Ä–æ–≤–µ—Ä—å –ø–æ—Ä—Ç
ufw allow 443
```

### –û—Ç—á—ë—Ç—ã –Ω–µ –ø–∞—Ä—Å—è—Ç—Å—è
```bash
# –ü—Ä–æ–≤–µ—Ä—å —Ñ–æ—Ä–º–∞—Ç
–ú–∏–Ω–∏–º—É–º:
- –¢–∏–ø —Å–º–µ–Ω—ã (–£—Ç—Ä–æ/–î–µ–Ω—å/–í–µ—á–µ—Ä/–ù–æ—á—å)
- –î–∞—Ç–∞ (15.10)
- –•–æ—Ç—è –±—ã –æ–¥–Ω–∞ —Ü–∏—Ñ—Ä–∞ (—Ñ–∏–Ω–∞–Ω—Å—ã)
```

---

## üí° –ü–æ–ª–µ–∑–Ω—ã–µ —Å–æ–≤–µ—Ç—ã

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –ò—Å–ø–æ–ª—å–∑—É–π `gpt-4o-mini` –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏
- –í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫ –±—ã—Å—Ç—Ä–µ–µ GPT
- –û—á–∏—â–∞–π –±–∞–∑—É —Ä–µ–≥—É–ª—è—Ä–Ω–æ: `/cleanup`

### –û–±—É—á–µ–Ω–∏–µ
- –î–æ–±–∞–≤–ª—è–π —Ç–æ–ª—å–∫–æ –≤–∞–∂–Ω–æ–µ
- –ò—Å–ø–æ–ª—å–∑—É–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- –î–µ–¥—É–ø–ª–∏—Ü–∏—Ä—É–π: `/cleanup`

### –û—Ç—á—ë—Ç—ã
- –ê–¥–º–∏–Ω—ã —Å–¥–∞—é—Ç –æ—Ç—á—ë—Ç—ã –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–π —Å–º–µ–Ω—ã
- –ë–æ—Ç –ø–∞—Ä—Å–∏—Ç –ª—é–±–æ–π —Ñ–æ—Ä–º–∞—Ç
- –ü—Ä–æ–±–ª–µ–º—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ø–∞–¥–∞—é—Ç –≤ `/issues`

---

## üí∞ FinMon Module - –§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### üìã –û–ø–∏—Å–∞–Ω–∏–µ
–ú–æ–¥—É–ª—å –¥–ª—è —É–¥–æ–±–Ω–æ–π "–°–¥–∞—á–∏ —Å–º–µ–Ω—ã" –∞–¥–º–∏–Ω–∞–º–∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã—Ö –∫–ª—É–±–æ–≤ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–µ–π –≤ Google Sheets.

### üéØ –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

**–ö–æ–º–∞–Ω–¥—ã:**
- `/shift` - –°–¥–∞—Ç—å —Å–º–µ–Ω—É (–ø–æ—à–∞–≥–æ–≤—ã–π wizard —Å –∫–Ω–æ–ø–∫–∞–º–∏)
- `/balances` - –ü–æ–∫–∞–∑–∞—Ç—å —Ç–µ–∫—É—â–∏–µ –æ—Å—Ç–∞—Ç–∫–∏ –ø–æ –∫–∞—Å—Å–∞–º
- `/shifts` - –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ 10 —Å–º–µ–Ω (–≤–ª–∞–¥–µ–ª—å—Ü—É - –≤—Å–µ)

**–ü—Ä–æ—Ü–µ—Å—Å —Å–¥–∞—á–∏ —Å–º–µ–Ω—ã:**
1. –í—ã–±–æ—Ä –∫–ª—É–±–∞ (–†–∏–æ –æ—Ñ–∏—Ü/–∫–æ—Ä–æ–±–∫–∞, –ú–∏—á—É—Ä–∏–Ω—Å–∫–∞—è –æ—Ñ–∏—Ü/–∫–æ—Ä–æ–±–∫–∞)
2. –í—ã–±–æ—Ä –≤—Ä–µ–º–µ–Ω–∏ —Å–º–µ–Ω—ã (—É—Ç—Ä–æ/–≤–µ—á–µ—Ä)
3. –ü–æ—à–∞–≥–æ–≤—ã–π –≤–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö:
   - –í—ã—Ä—É—á–∫–∞: fact_cash, fact_card, qr, card2
   - –ö–∞—Å—Å—ã: safe_cash_end, box_cash_end, goods_cash
   - –†–∞—Å—Ö–æ–¥—ã: compensations, salary_payouts, other_expenses
   - –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å: joysticks_total, joysticks_in_repair, joysticks_need_repair, games_count
   - –•–æ–∑—è–π—Å—Ç–≤–æ: toilet_paper, paper_towels
   - –ü—Ä–∏–º–µ—á–∞–Ω–∏—è: notes
4. –ü–æ–∫–∞–∑ —Å–≤–æ–¥–∫–∏ –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
5. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ SQLite + Google Sheets

### üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª—è

```
modules/finmon/
‚îú‚îÄ‚îÄ __init__.py           # –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –º–æ–¥—É–ª—è
‚îú‚îÄ‚îÄ db.py                 # –†–∞–±–æ—Ç–∞ —Å SQLite
‚îú‚îÄ‚îÄ models.py             # Pydantic –º–æ–¥–µ–ª–∏
‚îú‚îÄ‚îÄ wizard.py             # Conversation handler –¥–ª—è –≤–≤–æ–¥–∞ –¥–∞–Ω–Ω—ã—Ö
‚îî‚îÄ‚îÄ sheets.py             # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Google Sheets

migrations/
‚îî‚îÄ‚îÄ finmon_001_init.sql   # SQL –º–∏–≥—Ä–∞—Ü–∏—è —Ç–∞–±–ª–∏—Ü
```

### ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞

**–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env):**
```env
# FinMon Configuration
FINMON_DB_PATH=knowledge.db
FINMON_SHEET_NAME=ClubFinance
GOOGLE_SA_JSON=/opt/club_assistant/service-account.json
OWNER_TG_IDS=123456789,987654321
```

**Google Sheets Setup:**
1. –°–æ–∑–¥–∞—Ç—å service account –≤ Google Cloud Console
2. –°–∫–∞—á–∞—Ç—å JSON –∫–ª—é—á –≤ `/opt/club_assistant/service-account.json`
3. –î–∞—Ç—å –¥–æ—Å—Ç—É–ø –∫ Google Sheets email –∏–∑ JSON

### üé® –ü—Ä–∏–º–µ—Ä —Å–≤–æ–¥–∫–∏ —Å–º–µ–Ω—ã

```
[–†–∏–æ –æ—Ñ–∏—Ü] –£—Ç—Ä–æ 20.10
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
–§–∞–∫—Ç –Ω–∞–ª: 2 640 ‚ÇΩ | –°–µ–π—Ñ: 927 ‚ÇΩ
–§–∞–∫—Ç –±–µ–∑–Ω–∞–ª: 5 547 ‚ÇΩ | QR: 1 680 ‚ÇΩ | –ù–æ–≤–∞—è –∫–∞—Å—Å–∞: 0 ‚ÇΩ
–¢–æ–≤–∞—Ä–∫–∞ (–Ω–∞–ª): 1 000 ‚ÇΩ | –ö–æ—Ä–æ–±–∫–∞ (–Ω–∞–ª): 5 124 ‚ÇΩ
–ö–æ–º–ø/–∑–ø/–ø—Ä–æ—á–∏–µ: -650 / 3 000 / 0 ‚ÇΩ

–ì–µ–π–º–ø–∞–¥—ã: 153 (—Ä–µ–º–æ–Ω—Ç: 3, —Ç—Ä–µ–±—É–µ—Ç—Å—è: 3)
–ò–≥—Ä: 31

–¢—É–∞–ª–µ—Ç–∫–∞: –µ—Å—Ç—å | –ü–æ–ª–æ—Ç–µ–Ω—Ü–∞: –Ω–µ—Ç

–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –í—Å–µ –û–ö
```

### üìä Google Sheets —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

**–õ–∏—Å—Ç "Shifts":**
- –î–∞—Ç–∞, –í—Ä–µ–º—è, –ö–ª—É–±, –ê–¥–º–∏–Ω
- –§–∞–∫—Ç –Ω–∞–ª, –§–∞–∫—Ç –±–µ–∑–Ω–∞–ª, QR, –ù–æ–≤–∞—è –∫–∞—Å—Å–∞
- –°–µ–π—Ñ, –ö–æ—Ä–æ–±–∫–∞, –¢–æ–≤–∞—Ä–∫–∞
- –ö–æ–º–ø, –ó–ü, –ü—Ä–æ—á–∏–µ
- –ì–µ–π–º–ø–∞–¥—ã, –†–µ–º–æ–Ω—Ç, –¢—Ä–µ–±—É–µ—Ç—Å—è, –ò–≥—Ä
- –¢—É–∞–ª–µ—Ç–∫–∞, –ü–æ–ª–æ—Ç–µ–Ω—Ü–∞, –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ

**–õ–∏—Å—Ç "Balances":**
- –ö–ª—É–±, –¢–∏–ø –∫–∞—Å—Å—ã, –ë–∞–ª–∞–Ω—Å, –û–±–Ω–æ–≤–ª–µ–Ω–æ

### üí° –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- **Wizard –Ω–∞ python-telegram-bot FSM** - –ø–æ—à–∞–≥–æ–≤—ã–π –≤–≤–æ–¥ —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
- **Inline –∫–Ω–æ–ø–∫–∏** - –¥–ª—è –≤—ã–±–æ—Ä–∞ –∫–ª—É–±–∞ –∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
- **–ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - —Å–≤–æ–¥–∫–∞ —Å —ç–º–æ–¥–∑–∏ –∏ –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ–º
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - —Ç–æ–ª—å–∫–æ –≤–ª–∞–¥–µ–ª—å—Ü—ã –≤–∏–¥—è—Ç –≤—Å–µ —Å–º–µ–Ω—ã
- **Google Sheets sync** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- **–í–∞–ª–∏–¥–∞—Ü–∏—è** - Pydantic –º–æ–¥–µ–ª–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–∞–Ω–Ω—ã—Ö

---

## üìà Roadmap

### v4.12 (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)
- [ ] Web-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- [ ] Telegram Web App –¥–ª—è –æ—Ç—á—ë—Ç–æ–≤
- [ ] –≠–∫—Å–ø–æ—Ä—Ç –æ—Ç—á—ë—Ç–æ–≤ –≤ Excel
- [ ] –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø—Ä–æ–±–ª–µ–º–∞—Ö
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å CRM

### v5.0 (–±—É–¥—É—â–µ–µ)
- [ ] –ú—É–ª—å—Ç–∏–∫–ª—É–±–æ–≤–æ—Å—Ç—å
- [ ] –†–æ–ª–∏ –∏ –ø—Ä–∞–≤–∞
- [ ] API –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π
- [ ] Dashboard —Å –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

- GitHub Issues: https://github.com/nik45114/Bot_Claude/issues
- Telegram: @nik45114

---

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License

---

## ‚ú® –í–µ—Ä—Å–∏–∏

### v4.11 (—Ç–µ–∫—É—â–∞—è)
- ‚úÖ V2Ray Manager
- ‚úÖ Club Management System
- ‚úÖ –ê–≤—Ç–æ–ø–∞—Ä—Å–∏–Ω–≥ –æ—Ç—á—ë—Ç–æ–≤
- ‚úÖ ConversationHandler –¥–ª—è –æ—Ç—á—ë—Ç–æ–≤

### v4.10
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–≤—Ç–æ–æ–±—É—á–µ–Ω–∏—è
- ‚úÖ –£–ª—É—á—à–µ–Ω–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã

### v4.0-4.9
- ‚úÖ RAG –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- ‚úÖ –í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫
- ‚úÖ –ê–≤—Ç–æ–æ–±—É—á–µ–Ω–∏–µ
- ‚úÖ Draft queue

### v3.0
- ‚úÖ –ë–∞–∑–æ–≤–∞—è –±–∞–∑–∞ –∑–Ω–∞–Ω–∏–π
- ‚úÖ GPT –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

---

**üöÄ Club Assistant Bot v4.11 - –í—Å—ë –≤ –æ–¥–Ω–æ–º –±–æ—Ç–µ!**
